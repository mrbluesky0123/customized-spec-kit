---
description: 프로젝트 전체의 비즈니스 명세 및 시스템 명세 생성 또는 업데이트
---

## 사용자 입력

$ARGUMENTS

진행하기 전에 사용자 입력을 **반드시** 고려해야 합니다 (비어있지 않은 경우).

## 개요

트리거 메시지에서 `/mysddflow.specify` 뒤에 **사용자가 입력한 텍스트가 프로젝트 설명**입니다. `$ARGUMENTS`가 아래에 문자 그대로 나타나더라도 이 대화에서 항상 사용 가능하다고 가정하십시오. 사용자가 빈 명령을 제공하지 않는 한 반복하도록 요청하지 마십시오.

이 명령은 **비즈니스 명세**와 **시스템 명세** 두 개의 독립적인 문서를 순차적으로 생성합니다:

1. **1단계: 비즈니스 명세** - 사용자 요구사항, 비즈니스 가치, 사용자 시나리오에 집중
2. **2단계: 시스템 명세** - 기술적 요구사항, 시스템 아키텍처, 성능 제약사항에 집중

## 비즈니스 명세 vs 시스템 명세 구분 원칙

### 비즈니스 명세 (business-spec.md)의 책임 범위

**"무엇을(What)" 제공할 것인가**

포함해야 할 내용:

-   사용자 요구사항 및 비즈니스 목표
-   사용자 시나리오 및 여정
-   비즈니스 기능 요구사항 (예: "회원은 상품을 주문할 수 있어야 함")
-   비즈니스 규칙 및 제약사항 (예: "재고 부족 시 주문 거부")
-   비즈니스 수준의 성공 기준

포함하지 말아야 할 내용 (Plan 단계에서 처리):

-   API 엔드포인트 설계 (POST /api/v1/orders 등)
-   요청/응답 데이터 구조
-   HTTP 메소드 및 상태 코드

예시:

-   "회원은 이름, 전화번호, 성별, 생년월일을 입력하여 가입할 수 있어야 함"
-   "재고가 부족한 경우 주문은 거부되어야 함"
-   "탈퇴한 회원은 30일 이내에 탈퇴를 철회할 수 있어야 함"

### 시스템 명세 (sys-spec.md)의 책임 범위

**"어떻게(How)" 구현할 것인가 - 기술적 사양**

포함해야 할 내용:

-   기술 스택 (언어, 프레임워크, 라이브러리, 버전)
-   시스템 아키텍처 (컴포넌트 구성, 레이어 구조)
-   데이터베이스 종류 및 접근 방식 (JPA, MyBatis 등)
-   동시성 제어 방식 (Optimistic/Pessimistic Locking)
-   트랜잭션 관리 방식
-   외부 시스템 연동 방식 (Mock, Stub, 실제 연동)
-   성능/보안/확장성 요구사항 (NFR)
-   기술 표준 적용 여부 (맛간장, LMS, EAM 등)

예시:

-   "데이터베이스는 JPA를 통해 접근하며, H2/MySQL/PostgreSQL 중 선택 가능해야 함"
-   "재고 차감 시 동시성 제어는 JPA Optimistic Locking(@Version)을 사용해야 함"
-   "결제 API는 Mock으로 구현하며, 1초 지연과 1% 실패율을 시뮬레이션해야 함"
-   "시스템은 초당 100건의 API 요청을 처리할 수 있어야 함"

### 구분이 애매한 경우 판단 기준

다음 질문으로 판단:

1. "이 내용이 사용자/비즈니스 가치와 직접 연관되는가?" → YES면 비즈니스 명세
2. "이 내용이 기술 선택/구현 방식에 관한 것인가?" → YES면 시스템 명세
3. "API 엔드포인트/요청응답 형식인가?" → Plan 단계
4. "프레임워크/라이브러리/아키텍처 패턴인가?" → 시스템 명세

## 실행 흐름

### 초기 설정

해당 프로젝트 설명이 주어지면 다음을 수행하십시오:

1. **프로젝트 명세 초기화**: 프로젝트 전체의 명세를 정의하므로 고정된 이름 `project-spec-init`을 사용합니다.

    - 개별 기능이 아닌 프로젝트 전체 명세이므로 번호가 필요 없음
    - 프로젝트의 전체 범위, 목표, 제약사항을 다룸

2. **브랜치 생성 및 체크아웃**:

    a. 먼저 원격에서 최신 정보 가져오기:

    ```bash
    git fetch --all --prune
    ```

    b. `project-spec-init` 브랜치가 이미 존재하는지 확인:

    - 로컬: `git branch | grep 'project-spec-init'`
    - 원격: `git ls-remote --heads origin | grep 'refs/heads/project-spec-init'`

    c. 브랜치 처리:

    - 존재하지 않는 경우: 새 브랜치 생성 및 체크아웃
        ```bash
        git checkout -b project-spec-init
        ```
    - 이미 존재하는 경우: 해당 브랜치로 체크아웃
        ```bash
        git checkout project-spec-init
        ```

3. **프로젝트 명세 디렉토리 구조 생성**:

    a. 프로젝트 루트에 명세 디렉토리가 있는지 확인:

    ```bash
    mkdir -p specs/project-spec-init
    ```

    b. 필요한 하위 디렉토리 생성:

    ```bash
    mkdir -p specs/project-spec-init/checklists
    ```

### 1단계: 비즈니스 명세 생성

1. `templates/business-spec-template.md`를 로드하여 필수 섹션을 이해합니다.

2. 다음 실행 흐름을 따르십시오:

    1. 입력에서 사용자 설명 파싱
       비어 있는 경우: ERROR "프로젝트 설명이 제공되지 않음"
    2. 설명에서 주요 비즈니스 개념 추출
       식별: 비즈니스 목표, 사용자 유형, 사용자 가치, 비즈니스 제약사항
    3. 불명확한 측면의 경우:
        - 컨텍스트 및 비즈니스 도메인 표준을 기반으로 정보에 입각한 추측
        - 다음의 경우에만 [NEEDS CLARIFICATION: 구체적 질문]으로 표시:
            - 선택이 비즈니스 가치 또는 사용자 경험에 큰 영향을 미침
            - 여러 합리적인 해석이 다른 의미를 가지고 존재
            - 합리적인 기본값이 존재하지 않음
        - 영향별로 명확화 우선순위 지정: 비즈니스 가치 > 사용자 경험 > 범위 > 데이터/프로세스
        - 질문이 많을 경우 우선순위에 따라 정리하여 사용자의 인지적 부하를 고려
    4. 사용자 시나리오 및 사용자 여정 정의
       명확한 사용자 흐름이 없는 경우: ERROR "사용자 시나리오를 결정할 수 없음"
    5. 비즈니스 요구사항 생성
       각 요구사항은 비즈니스 가치와 연결되어야 함
       불명확한 세부사항은 사용자에게 명확화 요청 (질문 내용을 `specs/project-spec-init/clarifications.md`에 문서화)
    6. 성공 기준 정의
       측정 가능한 비즈니스 결과 생성
       사용자 만족도, 업무 효율성, 비즈니스 메트릭 포함
       각 기준은 기술 세부사항 없이 비즈니스 관점에서 확인 가능해야 함
    7. 주요 사용자 및 이해관계자 식별

3. **템플릿 엄격 준수**: 템플릿 구조를 사용하여 `specs/project-spec-init/business-spec.md`에 명세를 작성하되:

    - **절대 섹션 제목을 변경하지 마시오**
    - **절대 섹션 순서를 바꾸지 마시오**
    - **템플릿에 없는 _(필수)_ 표시를 추가하지 마시오**
    - **템플릿에 있는 _(필수)_ 표시를 제거하지 마시오**
    - **플레이스홀더([...]) 내용만 교체하고 나머지 구조는 그대로 유지**
    - **템플릿 위반 시 작업을 중단하고 다시 시작**

4. **비즈니스 명세 품질 검증**: [시스템 명세와 동일한 검증 프로세스]

### 2단계: 시스템 명세 생성

비즈니스 명세가 완료된 후:

1. `templates/system-spec-template.md`를 로드하여 필수 섹션을 이해합니다.

2. **비즈니스 명세 참조**: `specs/project-spec-init/business-spec.md`에서 비즈니스 요구사항 및 제약사항을 파악합니다.

3. 다음 실행 흐름을 따르십시오:

    1. 비즈니스 명세에서 기술적 함의 추출
       식별: 프로젝트 목표, 시스템 범위, 이해관계자, 주요 제약사항
    2. 불명확한 측면의 경우:
        - 컨텍스트 및 업계 표준을 기반으로 정보에 입각한 추측
        - 다음의 경우에만 [NEEDS CLARIFICATION: 구체적 질문]으로 표시:
            - 선택이 프로젝트 범위 또는 시스템 아키텍처에 큰 영향을 미침
            - 여러 합리적인 해석이 다른 의미를 가지고 존재
            - 합리적인 기본값이 존재하지 않음
        - 영향별로 명확화 우선순위 지정: 프로젝트 범위 > 규제/규정 준수 > 성능/확장성 > 기술적 제약사항
        - 질문이 많을 경우 우선순위에 따라 정리하여 사용자의 인지적 부하를 고려
    3. 프로젝트 목표 및 이해관계자 섹션 채우기
       명확한 프로젝트 목적이 없는 경우: ERROR "프로젝트 목표를 결정할 수 없음"
    4. **필수 기술 표준 확인**: 사용자가 명시하지 않은 경우 다음 항목을 반드시 확인:
        - 자바 서버 프로젝트인 경우: "맛간장" (자바 서버 표준) 사용 여부
        - 감사 로그가 필요한 경우: LMS(카카오뱅크 감사로그 적재 시스템) 적재 여부
        - Admin 화면을 포함하는 프로젝트인 경우: EAM 적용 여부
          확인된 내용은 `specs/project-spec-init/clarifications.md`에 문서화
    5. **시스템 아키텍처 확인**: 비즈니스 명세에 시스템 아키텍처 정보가 불충분한 경우 다음을 요청:
       "시스템 아키텍처에 대한 정보가 필요합니다. 다음 내용을 포함하여 설명해주세요:

        1. **데이터 발생 지점**: 데이터는 어디서 생성되나요? (사용자 입력, 외부 API 호출, 파일 업로드, 이벤트 수신 등)
        2. **데이터 유입 경로**: 생성된 데이터가 본 애플리케이션에 도달하기 전 거치는 중간 계층이 있나요? (API Gateway, Load Balancer, 메시지 큐, 프록시 서버 등)
        3. **내부 처리 흐름**: 애플리케이션 내부에서 데이터가 어떻게 처리되나요? (유효성 검증 → 비즈니스 로직 수행 → 데이터베이스 저장 → 외부 시스템 호출 등)
        4. **데이터 출력 경로**: 처리된 데이터는 최종적으로 어디로 전달되나요? (사용자 응답, 외부 시스템 전송, 저장소 보관, 이벤트 발행 등)
        5. **외부 시스템 연동**: 연동하는 외부 시스템이 있나요? (있다면 시스템명, 연동 방식, 연동 목적을 명시)"

        응답을 받으면 이를 기반으로 시스템 구성도(ASCII 다이어그램) 및 컴포넌트 상세 설명 작성

    6. 시스템 요구사항 생성

        **중요: 시스템 요구사항은 기술 사양에 집중**

        시스템 요구사항은 **"어떤 기술로, 어떤 방식으로 구현할 것인가"** 에 초점을 맞춰야 합니다.

        **시스템 요구사항에 포함해야 할 것**:

        - 사용할 프로그래밍 언어 및 버전 (예: "Java 11 이상")
        - 프레임워크 및 버전 (예: "Spring Boot 2.7.x 이상")
        - 데이터베이스 종류 및 접근 기술 (예: "JPA를 사용하여 H2/MySQL/PostgreSQL 접근")
        - 동시성 제어 방식 (예: "JPA Optimistic Locking 사용")
        - 트랜잭션 관리 방식 (예: "Spring @Transactional 사용")
        - 외부 시스템 연동 방식 (예: "결제 API는 Mock으로 구현, 1초 지연/1% 실패율")
        - 시스템 아키텍처 (예: "Controller-Service-Repository 레이어 구조")
        - 성능 요구사항 (예: "초당 100건 요청 처리")
        - 기술 표준 적용 (예: "맛간장 미적용, LMS 미적용")

        **시스템 요구사항에 포함하지 말아야 할 것**:

        - 비즈니스 기능 설명 (예: "회원은 주문할 수 있어야 함") → 비즈니스 명세
        - API 엔드포인트 및 요청/응답 형식 (예: "POST /api/v1/orders") → Plan 단계
        - 비즈니스 규칙 (예: "재고 부족 시 주문 거부") → 비즈니스 명세

        ✅ 올바른 시스템 요구사항 예시:

        - "SR-001: 백엔드는 Java 11 이상, Spring Boot 2.7.x 이상으로 구현되어야 함"
        - "SR-002: 데이터베이스 접근은 JPA를 사용하며, H2/MySQL/PostgreSQL을 지원해야 함"
        - "SR-003: 재고 동시성 제어는 JPA Optimistic Locking(@Version)을 사용해야 함"
        - "SR-004: 결제 처리는 Mock 서비스로 구현하며, 1초 지연과 1% 실패율을 시뮬레이션해야 함"
        - "SR-005: 시스템은 초당 100건의 API 요청을 처리할 수 있어야 함"

        ❌ 잘못된 예시:

        - "시스템은 상품 조회 API를 제공해야 함" → 비즈니스 명세
        - "주문 API는 POST /api/v1/orders 엔드포인트로 구현되어야 함" → Plan 단계

        각 요구사항은 검증 가능해야 함
        불명확한 세부사항은 사용자에게 명확화 요청 (질문 내용을 `specs/project-spec-init/clarifications.md`에 문서화)

    7. 성공 기준 정의
       측정 가능한 프로젝트 수준 결과 생성
       비즈니스 목표, 시스템 성능, 품질 속성 포함
       각 기준은 프로젝트 완료 시점을 명확히 할 수 있어야 함

4. **템플릿 엄격 준수**: 템플릿 구조를 사용하여 `specs/project-spec-init/system-spec.md`에 명세를 작성하되:

    - **절대 섹션 제목을 변경하지 마시오**
    - **절대 섹션 순서를 바꾸지 마시오**
    - **템플릿에 없는 _(필수)_ 표시를 추가하지 마시오**
    - **템플릿에 있는 _(필수)_ 표시를 제거하지 마시오**
    - **플레이스홀더([...]) 내용만 교체하고 나머지 구조는 그대로 유지**
    - **템플릿 위반 시 작업을 중단하고 다시 시작**

5. **시스템 명세 품질 검증**: [기존 시스템 명세와 동일한 검증 프로세스]

## 품질 검증 프로세스

각 명세(비즈니스, 시스템) 작성 후 다음 품질 검증을 수행합니다:

### 비즈니스 명세 체크리스트

`specs/project-spec-init/checklists/business-requirements.md`에 다음 체크리스트를 생성:

```markdown
# 비즈니스 명세 품질 체크리스트: [프로젝트 이름]

**목적**: 비즈니스 명세 완전성 및 품질 검증
**생성일**: [날짜]
**프로젝트**: [business-spec.md에 대한 링크]

## 콘텐츠 품질

-   [ ] 구현 세부사항 없음 (언어, 프레임워크, API)
-   [ ] 사용자 가치 및 비즈니스 요구에 초점
-   [ ] 비기술 이해관계자를 위해 작성됨
-   [ ] 모든 필수 섹션 완료됨

## 요구사항 완전성

-   [ ] [NEEDS CLARIFICATION] 마커가 남아 있지 않음
-   [ ] 요구사항이 테스트 가능하고 모호하지 않음
-   [ ] 성공 기준이 측정 가능함
-   [ ] 성공 기준이 기술 독립적 (구현 세부사항 없음)
-   [ ] 모든 수락 시나리오가 정의됨
-   [ ] 엣지 케이스가 식별됨
-   [ ] 종속성 및 가정이 식별됨

## 기능 준비 상태

-   [ ] 모든 기능 요구사항에 명확한 수락 기준이 있음
-   [ ] 사용자 시나리오가 주요 흐름을 다룸
-   [ ] 기능이 성공 기준에 정의된 측정 가능한 결과를 충족함
-   [ ] 구현 세부사항이 명세에 누출되지 않음
```

### 시스템 명세 체크리스트

`specs/project-spec-init/checklists/system-requirements.md`에 다음 체크리스트를 생성:

```markdown
# 시스템 명세 품질 체크리스트: [프로젝트 이름]

**목적**: 시스템 명세 완전성 및 품질 검증
**생성일**: [날짜]
**프로젝트**: [system-spec.md에 대한 링크]

## 콘텐츠 품질

-   [ ] 필수 구현 세부사항이 명시됨 (프로그래밍 언어, 프레임워크, 표준 서버 구성 SDK 사용여부)
-   [ ] 시스템 수준의 기술 요구사항에 초점을 맞춤
-   [ ] 기술 이해관계자(개발자, 아키텍트)가 이해할 수 있도록 작성됨
-   [ ] 모든 필수 섹션이 완료됨

## 요구사항 완전성

-   [ ] [NEEDS CLARIFICATION] 마커가 남아 있지 않음 (또는 clarifications.md에 문서화됨)
-   [ ] 시스템 요구사항이 검증 가능하고 모호하지 않음
-   [ ] 성공 기준이 측정 가능함
-   [ ] 필수 기술 표준이 명시됨 (맛간장, LMS, EAM 등)
-   [ ] 주요 시스템 시나리오가 정의됨
-   [ ] 기술적 제약사항 및 엣지 케이스가 식별됨
-   [ ] 외부 시스템 종속성 및 가정이 식별됨

## 시스템 명세 준비 상태

-   [ ] 모든 시스템 요구사항에 명확한 검증 기준이 있음
-   [ ] 프로젝트 목표와 시스템 목적이 명확하게 정의됨
-   [ ] 시스템 경계, 범위, 인터페이스가 명확함
-   [ ] 아키텍처 제약사항과 기술 선택이 문서화됨
```

### 검증 실행

각 체크리스트에 대해:

1. **검증 확인 실행**: 각 체크리스트 항목에 대해 명세를 검토
2. **검증 결과 처리**:
    - **모든 항목 통과**: 다음 단계로 진행
    - **항목 실패**: 명세 업데이트 후 재검증 (최대 3회)
    - **[NEEDS CLARIFICATION] 존재**: 사용자에게 질문 제시

## 최종 보고

두 명세가 모두 완료되면 다음 정보로 완료 보고:

-   브랜치 이름: `project-spec-init`
-   생성된 파일:
    -   `specs/project-spec-init/business-spec.md`
    -   `specs/project-spec-init/system-spec.md`
    -   `specs/project-spec-init/checklists/business-requirements.md`
    -   `specs/project-spec-init/checklists/system-requirements.md`
    -   `specs/project-spec-init/clarifications.md` (필요한 경우)
-   체크리스트 결과
-   다음 단계 준비 상태

## 일반 지침

### 비즈니스 명세 지침

-   사용자가 **무엇을** 필요로 하고 **왜** 필요한지에 초점
-   구현 방법 피하기 (기술 스택, API, 코드 구조 없음)
-   개발자가 아닌 비즈니스 이해관계자를 위해 작성됨

### 시스템 명세 지침

-   프로젝트 전체의 **시스템 요구사항**과 **기술 제약사항**에 초점
-   구현 세부사항을 **명시**해야 함 (기술 스택, 프레임워크, 표준 서버 구성, SDK)
-   기술 이해관계자(개발자, 아키텍트)를 위해 작성됨

### 공통 지침

-   **필수 섹션**: 모든 명세에 대해 완료되어야 함
-   **선택적 섹션**: 프로젝트와 관련된 경우에만 포함
-   섹션이 적용되지 않는 경우 완전히 제거 ("N/A"로 남겨두지 마십시오)
-   명세에 포함된 체크리스트를 절대 생성하지 마십시오. 별도 파일로 관리됩니다.

**중요**: 이 명령은 비즈니스 명세를 먼저 완성한 후 시스템 명세를 작성하는 순차적 프로세스입니다. 각 단계는 이전 단계의 결과를 참조하여 일관성을 유지합니다.
